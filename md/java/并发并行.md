## 并行和并发

并发是两个任务共享时间段，并行则是两个任务在同一时间发生，比如运行在多核CPU上。
如果一个程序要运行两个任务，并且只有一个CPU给它们分配了不同的时间片，那么这就是并发，而不是并行。

> 并行化是指为缩短任务执行时间，将一个任务分解成几部分，然后并行执行。

这和顺序执行的任务量是一样的，区别就像用更多的马来拉车，花费的时间自然减少了。
实际上，和顺序执行相比，并行化执行任务时，CPU承载的工作量更大。

> 数据并行化是指将数据分成块，为每块数据分配单独的处理单元。

还是拿马拉车那个例子打比方，就像从车里取出一些货物，放到另一辆车上，两辆马车都沿着同样的路径到达目的地。

当需要在大量数据上执行同样的操作时，数据并行化很管用。
它将问题分解为可在多块数据上求解的形式，然后对每块数据执行运算，最后将各数据块上得到的结果汇总，从而获得最终答案。

人们经常拿任务并行化和数据并行化做比较，在任务并行化中，线程不同，工作各异。
我们最常遇到的JavaEE应用容器便是任务并行化的例子之一，每个线程不光可以为不同用户服务，
还可以为同一个用户执行不同的任务，比如登录或往购物车添加商品。

- 概念
  - 【并发】：你有一套方案，可以让多个人一起把事情做的更高效
  - 但如果你真的雇了10个人，就可以很容易的让第1个人干第1人份和第2人份的活，第2个人干第3和第4人份的活…… 而这10个人同时在工地上干活，就是【并行】（Parallelism）
- 【并行】的上限是由【并发】的方法的设计决定的
  - 如果想让一个事情变得容易【并行】，先得让制定一个【并发】的方法。
  - 倘若一个事情压根就没有【并发】的方法，那么无论有多少个可以干活的人，也不能【并行】。比如你让20个人不铺路，而是一起去拧同一个灯泡，也只能有一个人踩在梯子上去拧，其他19个人只能看着，啥也干不了。
- 常见的误解
  - 并发是多个任务交替使用CPU，同一时刻只有一个任务在跑；并行是多个任务同时跑
    - 这个错误的理解就是：并发和并行是两个并列的，非此即彼的概念，一个状态要不就是并行的，要不就是并发的。这是完全错误的
    - 实际上【并发】和【并行】描述的是两个频道的事情
  - 并发是多个任务交替使用CPU，同一时刻只有一个任务在跑
    - 其实正确的理解是：针对一个问题，想到了一个可以拆解为多个【并发】的任务，这些任务执行时因为只有一个CPU只能“切换”的跑。
  - 并行是多个任务同时跑
    - 其实的意思是：如果这些并行执行的任务是解决同一个问题的，那么他们既是【并发】的，同时也是【并行】的。
- 为什么要这么理解并发
  - 将大的任务拆解为许许多多小的可以并发的任务是重要的编程思想。
- 高并发
  - 不像【并发】说的是“处理”，【并行】说的是“执行”，【高并发】说的是最终效果。
  - 【高并发】是指可以让软件系统在一段时间内能够处理大量的请求。比如每秒钟可以完成10万个请求。这是互联网系统的一个重要的特征。
  - 极端一点【高并发】甚至并不一定需要【并行】，只要处理速度快的足够满足要求就可以。如启动一个nginx的【OS进程】，它只能用到一个CPU核心，也就不可能【并行】。但是他如果能每秒能处理10万个请求，而业务需求只要求8万个请求就可以了，那么这个单进程的nginx本身就算【高并发】了。
- 并发这个词其实可以分两种方向来理解，一个是宏观，一个是微观。宏观就顾名思义就行了，即同时发生的请求或事件，就叫并发。微观理解就是，多个线程在同一个物理资源下的具体操作，不管单核也好双核也好